from typing import Any, Dict, List
from modules.logger import Logger
from pymetasploit3.msfrpc import MsfRpcClient

client = MsfRpcClient('password', ssl=True)

def search_exploits(vulnerability: Dict[str, Any], log: Logger) -> List[str]:
    """
    Search for exploits related to a given vulnerability using Metasploit.
    
    :param vulnerability: A dictionary containing vulnerability details.
    :param log: Logger object for logging.
    :return: A list of exploit module names.
    """
    log.logger("info", f"Searching for exploits related to {vulnerability['CVEID']}")
    
    exploits = client.modules.search(vulnerability['CVEID'])
    exploit_names = [exploit['fullname'] for exploit in exploits if exploit['type'] == 'exploit']
    
    log.logger("info", f"Found {len(exploit_names)} exploits for {vulnerability['CVEID']}")
    return exploit_names
